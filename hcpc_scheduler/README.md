# HCPC Priority Scheduler / HCPC 优先级调度器

**HCPC Priority Scheduler** --- A scheduler designed for GPU and CPU task allocation in the Apollo Autonomous Driving System. It analyzes random DAG graphs, computes node weights based on user-defined inputs, identifies critical paths, and outputs detailed resource allocation for scheduling research.

**HCPC 优先级调度器** --- 针对 Apollo 自动驾驶系统中的 GPU 与 CPU 任务资源调度而设计的调度器。该调度器分析随机生成的 DAG 图，根据用户预设的节点权重计算，并识别关键路径，输出详细的资源分配信息，用于调度研究。

---

## Table of Contents / 目录
- [Overview / 简介](#overview--简介)
- [Input Description / 输入说明](#input-description--输入说明)
- [Algorithm Process / 算法流程](#algorithm-process--算法流程)
- [Output Example / 输出示例](#output-example--输出示例)
- [Usage / 使用方法](#usage--使用方法)
- [Dependencies and Environment / 依赖与环境要求](#dependencies-and-environment--依赖与环境要求)
- [Note / 备注](#note--备注)

---

## Overview / 简介
This algorithm analyzes random DAG graphs generated by the `dag-gen-rnd` module. Users manually assign weights to nodes (e.g., setting the start and sink nodes to 0 to indicate no load), after which the algorithm parses the graph to determine the critical path, maximum number of GPU partitions, and detailed scheduling information for CPU and GPU tasks.

该算法用于分析由 `dag-gen-rnd` 模块生成的随机 DAG 图。用户需手动为各节点设定权重（例如，将起始节点和终止节点的权重设为 0，表示无负载），算法随后解析图结构，识别关键路径，计算 GPU 最大分区数量，并输出 CPU 与 GPU 任务的详细调度信息。

---

## Input Description / 输入说明

- **Task Data / 任务属性数据**  
  Example:
  ```python
  tasks_data = [
      (1, {'rank': 0, 'task_type': 'CPU'}),
      # Other tasks...
  ]
Each tuple contains a task ID and a dictionary of task attributes.

## Algorithm Process / 算法流程

Preprocessing and Weight Assignment / 预处理与权重定义
Users manually input the weights for each node, ensuring that the start and sink nodes are set to 0.

用户在此阶段手动输入各节点权重，确保例如起始节点与终止节点的权重为 0，再根据实际负载进行调度。

DAG Graph Analysis / DAG 图分析
The algorithm parses the DAG graph, identifies the critical path, computes the total project duration, and groups nodes into Capacity Providers (CP groups) with associated F and G sets, as well as potential parallel regions (R).

算法解析 DAG 图，识别关键路径、计算项目总工期，并将节点合并生成 Capacity Providers（CP 组）及各自的 F 与 G 集合，同时确定潜在的并行区域 R。

Resource Management and Scheduling Output / 资源管理与调度输出
The algorithm outputs the following:

Node Weights / 节点权重
Critical Path / 关键路径
Total Project Duration / 项目总工期
All Nodes / 所有节点
Merged Capacity Providers (CP groups) / 合并后的 CP 组
F and G Sets for each CP / 各 CP 对应的 F 与 G 集合
Potential Parallel Regions (R) for each CP / 各 CP 潜在并行区域 R
GPU Task Count in each R / 各 R 中 GPU 任务数量统计
Maximum Number of GPU Partitions / GPU 最大分区数量
GPU Task Dependencies / GPU 任务之间的依赖关系
Independent GPU Tasks / 独立的 GPU 任务
CPU Task Priority Distribution / CPU 任务优先度分配结果